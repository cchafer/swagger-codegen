package {{package}}

{{#imports}}import {{import}}
{{/imports}}
import {{modelPackage}}._
import {{invokerPackage}}._
import akka.actor.ActorSystem
import spray.http._
import scala.util.{Failure, Success}

{{#operations}}
object {{classname}} extends JsonUnmarshalling {

  import ApiUtils.Mappable._

{{#operation}}
  def {{operationId}}({{#allParams}}{{paramName}}: {{#required}}{{dataType}}{{/required}}{{^required}}Option[{{dataType}}]{{/required}}{{#defaultValue}} = {{{defaultValue}}}{{/defaultValue}}{{^defalutValue}}{{^required}} = None{{/required}}{{/defalutValue}}{{#hasMore}}, {{/hasMore}}{{/allParams}}) =
    ApiRequest(
      "{{basePath}}",
      "{{path}}",
      "application/x-www-form-urlencoded",
      HttpMethods.{{httpMethod.toUpperCase}},
      // FormParams
      Map[String, String](){{#formParams}}
          .add("{{paramName}}", {{paramName}}){{/formParams}},
      // QueryParams
      Map[String, String](){{#queryParams}}
          .add("{{paramName}}", {{paramName}}){{/queryParams}},
      // HeaderParams
      Map[String, String](){{#headerParams}}
          .add("{{paramName}}", {{paramName}})
      {{/headerParams}},
      { {{#responses}}{{^isWildcard}}
          case response@HttpResponse(code, _, _, _) if code.intValue == {{code}} =>
              {{#dataType}}extractFromJsonResponse[{{dataType}}](response){{/dataType}}{{^dataType}}ApiResponse(None, {{code}}, durationValue(response)){{/dataType}}
          {{/isWildcard}}{{/responses}}
        {{#responses}}{{#isWildcard}}
          case response@HttpResponse(code, _, _, _) =>
              {{#dataType}}extractFromJsonResponse[{{dataType}}](response){{/dataType}}{{^dataType}}ApiResponse(None, {{code}}, durationValue(response)){{/dataType}}
        {{/isWildcard}}{{/responses}}
        {{^hasWildcardResponse}}
          case response@HttpResponse(code, entity, headers, _) =>
            throw new RuntimeException("Answer not understood : " + code + " " + entity.toString)
        {{/hasWildcardResponse}}
      }
    )

{{/operation}}
}

{{/operations}}